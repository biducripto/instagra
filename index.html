<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Gerador de Postagem Imobili√°ria</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #eef1f5;
      padding: 20px;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    canvas {
      display: block;
      margin: 20px auto;
      border: 2px dashed #ccc;
      background: #fff;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Gerador de Postagem Imobili√°ria</h1>

  <label>Importar dados (.json)</label>
  <input type="file" id="jsonInput" accept=".json">

  <label>Imagem de Fundo</label>
  <input type="file" id="imagemFundo" accept="image/*">

  <label>Logo</label>
  <input type="file" id="logo" accept="image/*">

  <label>T√≠tulo</label>
  <input type="text" id="titulo">

  <label>Pre√ßo</label>
  <input type="text" id="preco">

  <label>Condom√≠nio</label>
  <input type="text" id="condominio">

  <label>Dormit√≥rios</label>
  <input type="number" id="dormitorios">

  <label>Banheiros</label>
  <input type="number" id="banheiros">

  <label>Metragem</label>
  <input type="text" id="metragem">

  <label>Vagas</label>
  <input type="number" id="vagas">

  <label>Caracter√≠sticas</label>
  <textarea id="caracteristicas" rows="4"></textarea>

  <label>Telefone</label>
  <input type="text" id="telefone">

  <label>Site</label>
  <input type="text" id="site">

  <label>Instagram</label>
  <input type="text" id="instagram">

  <label>Cor do Texto</label>
  <input type="color" id="corTexto" value="#ffffff">

  <label>Cor da Sobreposi√ß√£o</label>
  <input type="color" id="corOverlay" value="#000000">

  <label>Opacidade da Sobreposi√ß√£o (%)</label>
  <input type="range" id="overlayOpacidade" min="0" max="100" value="80">

  <button onclick="gerarPostagem()">Gerar</button>
  <canvas id="canvas" width="1080" height="1080"></canvas>
  <button onclick="baixarImagem()">Baixar Imagem</button>
</div>

<script>
  let imagemFundo = null;
  let logoMarca = null;

  document.getElementById('imagemFundo').addEventListener('change', e => {
    const reader = new FileReader();
    reader.onload = evt => {
      imagemFundo = new Image();
      imagemFundo.onload = gerarPostagem;
      imagemFundo.src = evt.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  });

  document.getElementById('logo').addEventListener('change', e => {
    const reader = new FileReader();
    reader.onload = evt => {
      logoMarca = new Image();
      logoMarca.src = evt.target.result;
    };
    reader.readAsDataURL(e.target.files[0]);
  });

  document.getElementById('jsonInput').addEventListener('change', e => {
    const reader = new FileReader();
    reader.onload = evt => {
      const data = JSON.parse(evt.target.result);
      document.getElementById('titulo').value = data.titulo || '';
      document.getElementById('preco').value = data.valor || '';
      document.getElementById('condominio').value = data.condominio || '';
      document.getElementById('dormitorios').value = data.dormitorios || '';
      document.getElementById('banheiros').value = data.banheiros || '';
      document.getElementById('metragem').value = data.area_util || '';
      document.getElementById('vagas').value = data.vagas || '';
      document.getElementById('telefone').value = data.telefone || '';
      document.getElementById('site').value = data.site || '';
      document.getElementById('instagram').value = data.instagram || '';
      document.getElementById('caracteristicas').value = (data.caracteristicas || []).join('\n');
      gerarPostagem();
    };
    reader.readAsText(e.target.files[0]);
  });

  function gerarPostagem() {
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    const corOverlay = document.getElementById('corOverlay').value;
    const opacidade = parseInt(document.getElementById('overlayOpacidade').value) / 100;
    const corTexto = document.getElementById('corTexto').value;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (imagemFundo) ctx.drawImage(imagemFundo, 0, 0, canvas.width, canvas.height);

    ctx.fillStyle = hexToRgba(corOverlay, opacidade);
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    ctx.fillStyle = corTexto;
    ctx.font = 'bold 48px Segoe UI';
    ctx.fillText(document.getElementById('titulo').value, 40, 100);

    ctx.font = 'bold 40px Segoe UI';
    ctx.fillText(document.getElementById('preco').value, 40, 160);
    ctx.fillText(document.getElementById('condominio').value, 40, 210);

    ctx.font = '32px Segoe UI';
    ctx.fillText(`üõè ${document.getElementById('dormitorios').value}  üõÅ ${document.getElementById('banheiros').value}  üìê ${document.getElementById('metragem').value}  üöó ${document.getElementById('vagas').value}`, 40, 260);

    ctx.font = '26px Segoe UI';
    const lista = document.getElementById('caracteristicas').value.split('\n');
    lista.forEach((item, i) => ctx.fillText('‚Ä¢ ' + item, 40, 310 + i * 34));

    ctx.font = '22px Segoe UI';
    ctx.fillText(`üìû ${document.getElementById('telefone').value}   üåê ${document.getElementById('site').value}   üì∏ ${document.getElementById('instagram').value}`, 40, canvas.height - 40);

    if (logoMarca) ctx.drawImage(logoMarca, canvas.width - 200, 40, 160, 80);
  }

  function hexToRgba(hex, alpha) {
    const r = parseInt(hex.substr(1, 2), 16);
    const g = parseInt(hex.substr(3, 2), 16);
    const b = parseInt(hex.substr(5, 2), 16);
    return `rgba(${r},${g},${b},${alpha})`;
  }

  function baixarImagem() {
    const canvas = document.getElementById('canvas');
    const link = document.createElement('a');
    link.download = 'postagem.png';
    link.href = canvas.toDataURL();
    link.click();
  }
</script>
</body>
</html>
